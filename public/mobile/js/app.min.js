window.onload=function(b){var a=window.YDUI.dialog;$("header").on("click",".back",function(){history.back()});u=window.location.href;$("footer a").each(function(e,d){if(d.href==u){$(d).addClass("active")}});var c=$("section")[0].id;switch(c){case"index":index(a);break;case"list":list(a);break;case"cart":cart(a);break;case"user":user(a);break;case"goods":goods(a);break;case"recharge":recharge(a);break;case"agent":agent(a);break}};function index(a){$("#J_Slider").slider({speed:200,autoplay:2000,lazyLoad:true});app.Infinite("#index",".recom-content",{url:"",success:function(b){console.log(b)}})}function list(a){}function cart(a){var a=YDUI.dialog;$(".scroll-box").on("click",".add",function(){var d=$(this).parents(".shop-item").attr("data-id");var c=$(this).parents(".shop-item");if(!d){return}app.ajax("","get",{type:"add",id:d},function(f,e){if(f.status){c.find("num").text(c.find("num").text()*1+1);b()}if(f.info){e.toast(f.info,"none",1000)}})});$(".scroll-box").on("click",".pre",function(){var d=$(this).parents(".shop-item").attr("data-id");var c=$(this).parents(".shop-item");if(!d){return}app.ajax("","get",{type:"pre",id:d},function(f,e){if(f.status){c.find("num").text(c.find("num").text()*1-1);b()}if(f.info){e.toast(f.info,"none",1000)}})});$(".scroll-box").on("click",".delet",function(){var d=$(this).parents(".shop-item").attr("data-id");var c=$(this).parents(".shop-item");if(!d){return}a.confirm("删除商品","确定要删除此商品吗？",[{txt:"取消",color:false,callback:function(){}},{txt:"删除",color:"red",callback:function(){app.ajax("","get",{id:d},function(e){if(e.status){c[0].remove();b()}if(e.info){a.toast(e.info,"none",1000)}})}}])});$(".submit-btn").on("click",function(){var c=$(".shop-item").length;if(c<=0){return}a.confirm("订单提交","确定要购买购物车中的商品吗？",[{txt:"取消",color:false,callback:function(){}},{txt:"提交",color:"red",callback:function(){app.ajax("","get",{},function(d){if(d.info){a.toast(d.info,"none",1000,function(){if(d.url){location.href=d.url}})}else{if(d.url){location.href=d.url}}})}}])});function b(){var c=0;$(".shop-item").each(function(e,d){var g=$(d).find(".text-detail .centent span:first").text().substr(1)*1;var f=$(d).find(".num").text();c+=(g*f)});$(".prices em").text(c.toFixed(2))}}function user(a){$(".nac-top .back").click(function(){history.back()})}function goods(b){var d=this;$("#J_Slider").slider({speed:200,autoplay:3000,lazyLoad:true});$(".points span:last").text($(".slider-pagination-item").length);var c=$(".points span:first");var a=$(".slider-pagination-item");$(".slider-pagination").css("display","none");var e=setInterval(function(){a.each(function(g,f){if($(f).hasClass("slider-pagination-item-active")){c.text(g+1)}})},100);$(".top-btn").on("click",".open-win",function(){$(this).removeClass("open-win").addClass("close-win").text("关闭详情");$(".detail-box").css({height:"unset",padding:"10px"})});$(".top-btn").on("click",".close-win",function(){$(this).removeClass("close-win").addClass("open-win").text("查看详情");$(".detail-box").css({height:"0",padding:"0"})});$(".addCart").click(function(){$(".spec-mark").css("display","flex")});$(".buy").click(function(){$(".spec-mark").css("display","flex")});$(".spec-mark").on("click",function(f){if(f.stopPropagation){f.stopPropagation()}else{f.cancelBubble=true}$(this).css("display","none")});$(".spec-box").click(function(f){f.stopPropagation()});$(".spec-mark .item-box").on("click","span",function(){$(this).parents(".item-box").find("span").removeClass("on");$(this).addClass("on")});$(".input-row").on("click",".add",function(){var g=$(this).parents(".right").find(".num");var f=g.text()*1+1;if(f>99){b.toast("最多允许购买99件","none",1000);return false}g.text(f)});$(".input-row").on("click",".pre",function(){var g=$(this).parents(".right").find(".num");var f=g.text()*1-1;if(f<=0){b.toast("最少不能低于1件","none",1000);return false}g.text(f)});$(".btns").click(function(){var j=$(this).attr("data-url");var i=$(this).attr("data-id");var f=$(this).attr("data-type");var g=$(".input-row .num").text();var h={};h.id=i;h.type=f;h.spec=[];h.num=g;$(".item-box").each(function(n,m){var l=$(m).find("span");for(var o=0;o<l.length;o++){if(l.eq(o).hasClass("on")){var p=l.eq(o).attr("data-id");h.spec.push(p);break}}});d.ajax(j,"post",h)})}function recharge(a){$(".put-btn").on("click",function(){console.log(1);var b=$(".put-info em").text();$(".recharge-row input[type=number]").val(b)});app.bindForm(".ajax-submit")}function agent(a){$(".agent-item").on("click",function(){var b=$(this);$(".agent-item").removeClass("on");b.addClass("on")})};